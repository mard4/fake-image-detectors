# **Datasets and DataLoaders**

This section provides an overview of the datasets and corresponding data loaders used in the project. 

## **Datasets available**
- ### [**TrueFace Dataset**](#trueface-dataset)
  A dataset containing high-quality real and fake images organized into specific categories.

- ### [**TRUEFAKE Dataset**](#truefake-dataset)
  A comprehensive dataset featuring images generated by various models and real counterparts.

- ### [**FORLAB Dataset**](#forlab-dataset)
  Exclusively includes real images for specialized tasks.

---

## **DataLoaders**
Efficient and customizable data loaders for the datasets:

- ### [**DataLoaders**](#dataloaders)
  Flexible loaders to streamline the data preparation pipeline, supporting transformations, batching, and custom splits.

------------

### TrueFace 

Dataset containing only Faces (Pre Social Network and Post Social Network image processing). 
It contains both Real and Fake images from different architectures and different social Networks.
- **Models**: StyleGAN, StyleGAN2
- **Social Networks**: Facebook, Telegram, Twitter, Whatsapp

Directory Structure

- **TrueFace**: `/media/NAS/TrueFace/TrueFace`
  - **TrueFace_PreSocial**
    - **Real**
      - `FFHQ`
    - **Fake**
      - **StyleGAN**
        - `images-psi-0.5`
        - `images-psi-0.7`
      - **StyleGAN2**
        - `conf-f-psi-0.5`
        - `conf-f-psi-1`
  - **TrueFace_PostSocial**
    - **Facebook**
      - **Real**
        - `FFHQ`
      - **Fake**
        - **StyleGAN**
          - `images-psi-0.5`
          - `images-psi-0.7`
        - **StyleGAN2**
          - `conf-f-psi-0.5`
          - `conf-f-psi-1`
    - **Telegram**
      - **Real**
        - `FFHQ`
      - **Fake**
        - **StyleGAN**
          - `images-psi-0.5`
          - `images-psi-0.7`
        - **StyleGAN2**
          - `conf-f-psi-0.5`
          - `conf-f-psi-1`
    - **Twitter**
      - **Real**
        - `FFHQ`
      - **Fake**
        - **StyleGAN**
          - `images-psi-0.5`
          - `images-psi-0.7`
        - **StyleGAN2**
          - `conf-f-psi-0.5`
          - `conf-f-psi-1`
    - **Whatsapp**
      - **Real**
        - `FFHQ`
      - **Fake**
        - **StyleGAN**
          - `images-psi-0.5`
          - `images-psi-0.7`
        - **StyleGAN2**
          - `conf-f-psi-0.5`
          - `conf-f-psi-1`

---------------------------------------------------------------------

### TrueFake Dataset
The **TrueFake** is an experimental (in development) dataset that includes a variety of fake images.

- **Models**: FLUX.1, StableDiffusion1.5, StableDiffusion2, StableDiffusion3, StableDiffusionXL, StyleGAN3

**NOTE** labels? where are the real images?????

- **TrueFake**: `/media/NAS/TrueFake`
  - **Extension**
    - **FLUX.1**
      - animals
      - faces
      - general  
      - landscapes
    - **StableDiffusion1.5**
      - animals
      - animals_backup
      - faces
      - general
      - landscapes
    - **StableDiffusion2**
      - animals
      - animals_backup
      - faces
      - general
      - landscapes
    - **StableDiffusion3**
      - animals
      - animals_backup
      - faces
      - general
      - landscapes
    - **StableDiffusionXL**
      - animals
      - animals_backup
      - faces
      - general
      - landscapes
    - **StyleGAN3**
      - conf-t-psi-0.5  
      - conf-t-psi-1


---------------------------------------------------------------------
### FORLAB Dataset
The **FORLAB** dataset contains only real images.

**NOTA** subfolders are not complete bc idk if it's useful


- **FORLAB**: `/media/NAS/FORLAB`
    - broken_images  
    - camera_fingerprint  
    - cameras
        - canon      
        - gopro  
        - 'leica camera ag'    
        - 'olympus corporation'   
        - sigma
        - fujifilm 
        - leica  
        - 'nikon corporation'   
        - panasonic              
        - sony
    - download.sh  
    - nohup.log  
    - out_download.log  
    - smartphones

----------------------------------------------------
## **DataLoaders** dataloader.py

The `Datasettone` class navigates through the defined directories to extract images and their associated labels. It returns both the image and its corresponding label.

## TrueFace Dataloader
This dataloader loads data for both the 'Real' and 'Fake' classes, concatenating them for use in training or evaluation.

### Args:
- **main_category** (`str`): Main category of the dataset.
- **platform** (`str`): Platform name (e.g., 'Facebook').
- **styleGAN_type** (`str`): Type of StyleGAN used.
- **psi_value** (`str`): Psi value for StyleGAN.
- **batch_size** (`int`, optional): Batch size for the DataLoader.
- **transform** (`callable`, optional): Transformations to apply to the images.
- **max_images_per_class** (`int`, optional): Maximum number of images to load per class.

### Returns:
- **DataLoader**: A PyTorch DataLoader containing the combined dataset of both classes.

---

## TRUEFAKE Dataloader
This dataloader focuses on loading only the 'Fake' class images. 

!!!!! *IMPORTANT* !!!! When `ALL_MODELS` is set to `True`, it loads images from all available models. Alternatively, specific models can be selected by setting `ALL_MODELS` to `False` and providing a list of desired models.

### Args:
- **real_or_fake** (`str`): Specify `'Real'` or `'Fake'`.
- **batch_size** (`int`, optional): Batch size for the DataLoader.
- **transform** (`callable`, optional): Transformations to apply to the images.
- **max_images_per_class** (`int`, optional): Maximum number of images to load per class.
- **ALL_MODELS** (`str`, optional): Set to `'YES'` to load all models or `'NO'` to specify models.
- **models** (`list of str`, optional): List of model names to load when `ALL_MODELS` is `'NO'`.

### Returns:
- **DataLoader**: A PyTorch DataLoader containing the dataset for the selected configuration.